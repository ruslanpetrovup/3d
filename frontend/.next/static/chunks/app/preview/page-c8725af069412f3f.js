(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[517],{1101:(e,t,a)=>{Promise.resolve().then(a.bind(a,6746))},1146:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var r=a(5155),l=a(5695),n=a(2115),s=a(1890);function o(e){let{className:t,title:a}=e,o=(0,l.useRouter)(),[i,d]=(0,n.useState)(!1),c=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(!a)return;let r=new FormData;r.append("image",a);try{d(!0);let e=await fetch("".concat(s.env.NEXT_PUBLIC_API_URL,"/preview/generate-preview"),{method:"POST",body:r});if(!e.ok)throw Error("Upload failed");let t=await e.json();o.push("/preview?id=".concat(t.data.id))}catch(e){console.error("Ошибка при загрузке изображения:",e),alert("Не удалось загрузить изображение. Попробуйте снова.")}finally{d(!1)}};return(0,r.jsxs)(r.Fragment,{children:[i&&(0,r.jsxs)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex flex-col items-center justify-center z-50 text-white px-4",children:[(0,r.jsx)("div",{className:"w-16 h-16 border-4 border-white border-t-transparent rounded-full animate-spin mb-6"}),(0,r.jsxs)("div",{className:"text-center max-w-md",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Please wait..."}),(0,r.jsx)("p",{className:"text-sm text-gray-300",children:"We are generating an image based on your photo. It usually takes 10 to 30 seconds. Please do not close the page."})]})]}),(0,r.jsxs)("label",{className:t||"cursor-pointer bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 transition relative",children:[i?"Loading...":a||"Upload Image",(0,r.jsx)("input",{type:"file",accept:"image/*",className:"hidden",onChange:c,disabled:i})]})]})}},1469:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return i},getImageProps:function(){return o}});let r=a(8229),l=a(8883),n=a(3063),s=r._(a(1193));function o(e){let{props:t}=(0,l.getImgProps)(e,{defaultLoader:s.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let i=n.Image},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},6746:(e,t,a)=>{"use strict";a.d(t,{default:()=>m});var r=a(5155),l=a(6766),n=a(5695),s=a(2115),o=a(8544),i=a(1890);function d(e){let{isOpen:t,onClose:a,photoId:l}=e,[n,d]=(0,s.useState)({firstName:"",lastName:"",email:"",country:"",city:"",address:""}),[c,u]=(0,s.useState)(!1),m=async e=>{e.preventDefault(),u(!0);let t="".concat(n.country,", ").concat(n.city,", ").concat(n.address),a={first_name:n.firstName,last_name:n.lastName,email:n.email,shipping_address:t,photo_id:l};try{let e=await fetch("".concat(i.env.NEXT_PUBLIC_API_URL,"/order"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!e.ok)throw Error("Error creating order");let t=await e.json();if(null==t?void 0:t.paymentUrl)window.location.href=t.paymentUrl;else throw Error("Failed to get payment link")}catch(e){console.error("Error:",e),alert("Failed to place order. Please try again later.")}finally{u(!1)}};return t?(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",children:(0,r.jsxs)(o.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-[#1B263B] text-white p-6 rounded-2xl w-full max-w-md shadow-xl border border-white/10",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Place Order"}),(0,r.jsxs)("form",{className:"space-y-4",onSubmit:m,children:[(0,r.jsx)("input",{type:"text",placeholder:"First Name",value:n.firstName,onChange:e=>d({...n,firstName:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-[#0D1B2A] rounded-xl border border-white/10 focus:outline-none"}),(0,r.jsx)("input",{type:"text",placeholder:"Last Name",value:n.lastName,onChange:e=>d({...n,lastName:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-[#0D1B2A] rounded-xl border border-white/10 focus:outline-none"}),(0,r.jsx)("input",{type:"email",placeholder:"Email",value:n.email,onChange:e=>d({...n,email:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-[#0D1B2A] rounded-xl border border-white/10 focus:outline-none"}),(0,r.jsx)("input",{type:"text",placeholder:"Country",value:n.country,onChange:e=>d({...n,country:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-[#0D1B2A] rounded-xl border border-white/10 focus:outline-none"}),(0,r.jsx)("input",{type:"text",placeholder:"City",value:n.city,onChange:e=>d({...n,city:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-[#0D1B2A] rounded-xl border border-white/10 focus:outline-none"}),(0,r.jsx)("input",{type:"text",placeholder:"Address",value:n.address,onChange:e=>d({...n,address:e.target.value}),required:!0,className:"w-full px-4 py-3 bg-[#0D1B2A] rounded-xl border border-white/10 focus:outline-none"}),(0,r.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-[#F97316] hover:bg-orange-600 py-3 rounded-xl font-bold transition shadow-lg disabled:opacity-50",children:c?"Processing...":"Confirm Order"})]}),(0,r.jsx)("button",{onClick:a,className:"mt-4 text-sm text-gray-400 hover:underline",children:"Cancel"})]})}):null}var c=a(1146),u=a(1890);function m(){(0,n.useRouter)();let e=(0,n.useSearchParams)().get("id"),[t,a]=(0,s.useState)(!1),[o,i]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),x=async e=>{try{let t=await fetch("".concat(u.env.NEXT_PUBLIC_API_URL,"/preview/temp-photos/").concat(e));if(!t.ok)throw Error("Image fetch failed");let a=await t.json();p(a.data.url_image)}catch(e){console.error("Error loading image:",e)}};return(0,s.useEffect)(()=>{e&&x(e)},[e]),(0,r.jsxs)("main",{className:"min-h-screen bg-[#0D1B2A] text-white px-4 py-12 flex flex-col items-center",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-8 text-center leading-tight bg-gradient-to-r from-orange-400 via-pink-500 to-purple-600 bg-clip-text text-transparent uppercase",children:"Your Starter Pack!"}),(0,r.jsx)("div",{className:"relative w-full max-w-md mb-8",children:o?(0,r.jsx)("div",{className:"w-full aspect-square bg-[#1B263B] rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-gray-400 animate-pulse",children:"Generating..."})}):m?(0,r.jsx)(l.default,{src:m,alt:"Generated image",width:448,height:400,className:"rounded-xl border border-white/10 shadow-lg"}):(0,r.jsx)("div",{className:"w-full aspect-square bg-[#1B263B] rounded-xl flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-gray-400",children:"No image"})})}),(0,r.jsxs)("div",{className:"flex gap-4",children:[m&&(0,r.jsx)("button",{onClick:()=>{let e=document.createElement("a");e.href=m,e.download="starter-pack.png",document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"bg-[#1D3557] hover:bg-green-700 text-white px-6 py-3 rounded-xl transition",children:"Save"}),(0,r.jsx)(c.A,{className:"bg-[#1D3557] hover:bg-[#18314F] text-white px-6 py-3 rounded-xl transition",title:"Regenerate"})]}),(0,r.jsx)("button",{onClick:()=>a(!0),className:"bg-[#F97316] hover:bg-orange-600 text-white px-6 py-3 rounded-xl transition w-full mt-6 max-w-md",children:"Order now"}),e&&(0,r.jsx)(d,{isOpen:t,onClose:()=>a(!1),photoId:e})]})}},6766:(e,t,a)=>{"use strict";a.d(t,{default:()=>l.a});var r=a(1469),l=a.n(r)}},e=>{var t=t=>e(e.s=t);e.O(0,[637,63,441,684,358],()=>t(1101)),_N_E=e.O()}]);